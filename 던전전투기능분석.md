# Life RPG PWA 던전 전투 기능 분석

## 현재 상태
던전 전투 기능은 **구현되어 있지만**, 실제로 작동하지 않는 상태입니다.

## 문제점 분석

### 1. 던전 입장 불가
- 던전 리스트는 정상적으로 표시됨 (21개 던전)
- 하지만 모든 던전이 "입장 불가" 상태
- 던전 카드를 클릭해도 입장 모달이 표시되지 않음

### 2. 가능한 원인
1. **플레이어 레벨 문제**
   - 테스트 시 플레이어 레벨이 1로 초기화됨
   - 대부분의 던전이 더 높은 레벨을 요구함
   - 예: 슬라임 늪 (Lv.4+), 늑대 굴 (Lv.6+)

2. **에너지 부족**
   - 던전 입장에는 에너지가 필요함
   - 초기 에너지가 부족할 수 있음

3. **클릭 이벤트 문제**
   - `canEnter`가 false일 때 `onSelectDungeon`이 호출되지 않음
   - 레벨이 낮으면 클릭 자체가 작동하지 않음

## 던전 전투 시스템 구조

### 1. 컴포넌트 구조
```
DungeonTab (메인 컨트롤러)
├── DungeonListScreen (던전 목록)
│   └── ImprovedDungeonList (던전 카드 표시)
├── DungeonEntranceModal (입장 확인 모달)
├── DungeonBattleScreen (전투 화면)
└── DungeonResultScreen (결과 화면)
```

### 2. 전투 플로우
1. 던전 선택 → `handleSelectDungeon`
2. 입장 모달 표시 → `currentScreen = 'entrance'`
3. 입장 확인 → `handleEnterDungeon`
4. 전투 세션 생성 → `dungeonIntegrationService.enterDungeon`
5. 전투 진행 → `currentScreen = 'battle'`
6. 결과 표시 → `currentScreen = 'result'`

### 3. 서비스 레이어
- `dungeonService`: 던전 데이터 관리
- `dungeonIntegrationService`: 던전 세션 및 전투 관리
- `characterIntegrationService`: 캐릭터 상태 관리
- `combatService`: 전투 로직 처리

## 해결 방법

### 1. 테스트용 저레벨 던전 추가
가장 쉬운 던전도 Lv.4를 요구하므로, Lv.1 플레이어는 아무것도 할 수 없습니다.
초보자용 던전을 추가하거나 테스트 모드를 만들어야 합니다.

### 2. 플레이어 레벨 상승
테스트를 위해 플레이어 레벨을 올리거나, 던전 요구 레벨을 낮춰야 합니다.

### 3. 디버그 모드
개발 환경에서는 레벨 제한을 무시하는 옵션이 필요합니다.

## 결론
던전 전투 시스템은 **코드상으로는 완전히 구현**되어 있지만, **레벨 제한** 때문에 실제로 테스트할 수 없는 상태입니다. 

초보 플레이어가 접근할 수 있는 저레벨 던전이 없어서, 게임을 시작한 직후에는 던전 기능을 전혀 사용할 수 없습니다.